{% extends 'base.html' %}
{% load static %}
{% block title %}系统开放接口{% endblock %}
{% block system_security_backup_active %}active open{% endblock %}
{% block show_open_api_actice %}active{% endblock %}
{% load queryset_data %}


{% block css_content %}
{% endblock %}

{% block modal_content %}
    <!--修改按钮-->
    <div class="modal fade" id="modify" tabindex="-1" role="dialog" aria-labelledby="modifyLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form action="{% url 'change_api' %}" method="post">
                    {% csrf_token %}
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="modifyLabel">修改接口信息</h4>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label for="id_change_name" class="control-label">接口名称：</label>
                            <input type="text" class="form-control" id="id_change_name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="id_change_password" class="control-label">接口密码：</label>
                            <input type="text" class="form-control" id="id_change_password" name="password" required>
                        </div>
                        <div class="form-group">
                            <div class="card">
                                <ul id="myTabs" class="nav nav-tabs" role="tablist">
                                    <li class="active"><a href="#home_change" id="home-tab" role="tab"
                                                          data-toggle="tab">月度营业数据</a>
                                    </li>
                                    <li><a href="#profile1_change" role="tab" id="profile-tab"
                                           data-toggle="tab">季度营业数据</a>
                                    </li>
                                    <li><a href="#profile2_change" role="tab" id="profile-tab"
                                           data-toggle="tab">内控指标汇总</a>
                                    </li>
                                    <li><a href="#profile3_change" role="tab" id="profile-tab" data-toggle="tab">月度绩效考核结果</a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" id="myTabDrop1" class="dropdown-toggle" data-toggle="dropdown"
                                           aria-controls="myTabDrop1-contents" aria-expanded="false">更多 <span
                                                class="caret"></span></a>
                                        <ul class="dropdown-menu" id="myTabDrop1-contents">
                                            <li><a href="#dropdown1_change" id="dropdown1-tab" data-toggle="tab">季度绩效考核结果</a>
                                            </li>
                                            <li><a href="#dropdown2_change" id="dropdown2-tab"
                                                   data-toggle="tab">季度绩效奖金</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <div id="myTabContent" class="tab-content">
                                    <div class="tab-pane fade active in" id="home_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.year"
                                                       name="opened_data"
                                                       value="monthly_sales_data.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.month"
                                                       name="opened_data"
                                                       value="monthly_sales_data.month"><span>月份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.turnover"
                                                       name="opened_data"
                                                       value="monthly_sales_data.turnover"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.operating_expenses"
                                                       name="opened_data"
                                                       value="monthly_sales_data.operating_expenses"><span>营业费用</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.amount_repaid"
                                                       name="opened_data"
                                                       value="monthly_sales_data.amount_repaid"><span>回款额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.inventory"
                                                       name="opened_data"
                                                       value="monthly_sales_data.inventory"><span>库存量</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_sales_data.profit"
                                                       name="opened_data"
                                                       value="monthly_sales_data.profit"><span>利润额</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile1_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.year"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.quarter"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.turnover"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.turnover"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.operating_expenses"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.operating_expenses"><span>营业费用</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.amount_repaid"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.amount_repaid"><span>回款额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.inventory"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.inventory"><span>库存量</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_sales_data.profit"
                                                       name="opened_data"
                                                       value="quarterly_sales_data.profit"><span>利润额</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile2_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.order_date"
                                                       name="opened_data"
                                                       value="internal_control_indicators.order_date"><span>订单时间</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.order_number"
                                                       name="opened_data"
                                                       value="internal_control_indicators.order_number"><span>订单号</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.order_money"
                                                       name="opened_data"
                                                       value="internal_control_indicators.order_money"><span>订单额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.scheduled_delivery"
                                                       name="opened_data"
                                                       value="internal_control_indicators.scheduled_delivery"><span>计划交期</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.target_well_done_rate"
                                                       name="opened_data"
                                                       value="internal_control_indicators.target_well_done_rate"><span>目标成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.target_medical_expenses"
                                                       name="opened_data"
                                                       value="internal_control_indicators.target_medical_expenses"><span>目标医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.target_comprehensive_cost"
                                                       name="opened_data"
                                                       value="internal_control_indicators.target_comprehensive_cost"><span>目标综合成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.target_management_compliance"
                                                       name="opened_data"
                                                       value="internal_control_indicators.target_management_compliance"><span>目标管理符合数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.actual_delivery"
                                                       name="opened_data"
                                                       value="internal_control_indicators.actual_delivery"><span>实际交期</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.finished_number"
                                                       name="opened_data"
                                                       value="internal_control_indicators.finished_number"><span>完成数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.unfinished_number"
                                                       name="opened_data"
                                                       value="internal_control_indicators.unfinished_number"><span>未完成数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.actual_well_done_rate"
                                                       name="opened_data"
                                                       value="internal_control_indicators.actual_well_done_rate"><span>实际成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.actual_medical_expenses"
                                                       name="opened_data"
                                                       value="internal_control_indicators.actual_medical_expenses"><span>实际医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="internal_control_indicators.actual_cost"
                                                       name="opened_data"
                                                       value="internal_control_indicators.actual_cost"><span>实际成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="internal_control_indicators.actual_management_compliance"
                                                       name="opened_data"
                                                       value="internal_control_indicators.actual_management_compliance"><span>实际管理符合数</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile3_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.year"
                                                       name="opened_data"
                                                       value="monthly_performance.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.month"
                                                       name="opened_data"
                                                       value="monthly_performance.month"><span>月份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.delivery_rate"
                                                       name="opened_data"
                                                       value="monthly_performance.delivery_rate"><span>交付率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.well_done_rate"
                                                       name="opened_data"
                                                       value="monthly_performance.well_done_rate"><span>成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.medical_expenses"
                                                       name="opened_data"
                                                       value="monthly_performance.medical_expenses"><span>医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="monthly_performance.month_dig_cost"
                                                       name="opened_data"
                                                       value="monthly_performance.month_dig_cost"><span>当月挖掘成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       id="monthly_performance.field_management_well_rate"
                                                       name="opened_data"
                                                       value="monthly_performance.field_management_well_rate"><span>现场管理符合率</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="dropdown1_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.year"
                                                       name="opened_data"
                                                       value="quarterly_performance.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.quarter"
                                                       name="opened_data"
                                                       value="quarterly_performance.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.turnover"
                                                       name="opened_data"
                                                       value="quarterly_performance.turnover"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.operating_rate"
                                                       name="opened_data"
                                                       value="quarterly_performance.operating_rate"><span>营业费率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.repaid_rate"
                                                       name="opened_data"
                                                       value="quarterly_performance.repaid_rate"><span>回款率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.inventory_rate"
                                                       name="opened_data"
                                                       value="quarterly_performance.inventory_rate"><span>库存率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_performance.profit_rate"
                                                       name="opened_data"
                                                       value="quarterly_performance.profit_rate"><span>利润率</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="dropdown2_change">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.year"
                                                       name="opened_data"
                                                       value="quarterly_award.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.quarter"
                                                       name="opened_data"
                                                       value="quarterly_award.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.turnover_award"
                                                       name="opened_data"
                                                       value="quarterly_award.turnover_award"><span>营业额所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.operating_rate_award"
                                                       name="opened_data"
                                                       value="quarterly_award.operating_rate_award"><span>营业费率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.repaid_rate_award"
                                                       name="opened_data"
                                                       value="quarterly_award.repaid_rate_award"><span>回款率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.inventory_rate_award"
                                                       name="opened_data"
                                                       value="quarterly_award.inventory_rate_award"><span>库存率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.profit_rate_award"
                                                       name="opened_data"
                                                       value="quarterly_award.profit_rate_award"><span>利润率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" id="quarterly_award.total"
                                                       name="opened_data"
                                                       value="quarterly_award.total"><span>合计</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="id_change_request_method" class="control-label">请求方式：</label>
                            <select class="form-control" id="id_change_request_method" name="request_method" required>
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="POST+GET">POST+GET</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="id_change_introduction" class="control-label">接口简介：</label>
                            <input type="text" class="form-control" id="id_change_introduction" name="introduction"
                                   required>
                        </div>
                        <div class="form-group">
                            <label for="id_change_is_enabled" class="control-label">是否启用：</label>
                            <label class="lyear-switch switch-primary">
                                <input type="checkbox" id="id_change_is_enabled" name="is_enabled" value="True"
                                       checked="">
                                <span></span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <input hidden id="id_change_id" name="change_id">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="submit" class="btn btn-primary">确定</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!--新增按钮-->
    <div class="modal fade" id="add" tabindex="-1" role="dialog" aria-labelledby="addLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form action="{% url 'add_api' %}" method="post">
                    {% csrf_token %}
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="addLabel">新增系统接口</h4>
                    </div>

                    <div class="modal-body">
                        <div class="form-group">
                            <label for="id_name" class="control-label">接口名称：</label>
                            <input type="text" class="form-control" id="id_name" name="name" required>
                        </div>
                        <div class="form-group">
                            <label for="id_password" class="control-label">接口密码：</label>
                            <input type="text" class="form-control" id="id_password" name="password" required>
                        </div>
                        <div class="form-group">
                            <div class="card">
                                <ul id="myTabs" class="nav nav-tabs" role="tablist">
                                    <li class="active"><a href="#home_add" id="home-tab" role="tab"
                                                          data-toggle="tab">月度营业数据</a>
                                    </li>
                                    <li><a href="#profile1_add" role="tab" id="profile-tab" data-toggle="tab">季度营业数据</a>
                                    </li>
                                    <li><a href="#profile2_add" role="tab" id="profile-tab" data-toggle="tab">内控指标汇总</a>
                                    </li>
                                    <li><a href="#profile3_add" role="tab" id="profile-tab"
                                           data-toggle="tab">月度绩效考核结果</a>
                                    </li>
                                    <li class="dropdown">
                                        <a href="#" id="myTabDrop1" class="dropdown-toggle" data-toggle="dropdown"
                                           aria-controls="myTabDrop1-contents" aria-expanded="false">更多 <span
                                                class="caret"></span></a>
                                        <ul class="dropdown-menu" id="myTabDrop1-contents">
                                            <li><a href="#dropdown1_add" id="dropdown1-tab"
                                                   data-toggle="tab">季度绩效考核结果</a>
                                            </li>
                                            <li><a href="#dropdown2_add" id="dropdown2-tab" data-toggle="tab">季度绩效奖金</a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                                <div id="myTabContent" class="tab-content">
                                    <div class="tab-pane fade active in" id="home_add">
                                        <div class="example-box">
                                        <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="monthly_sales_data.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="monthly_sales_data.month"><span>月份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_sales_data.turnover"
                                                       name="opened_data"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_sales_data.operating_expenses"
                                                       name="opened_data"><span>营业费用</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_sales_data.amount_repaid"
                                                       name="opened_data"><span>回款额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_sales_data.inventory"
                                                       name="opened_data"><span>库存量</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_sales_data.profit"
                                                       name="opened_data"><span>利润额</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile1_add">
                                        <div class="example-box">
                                        <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_sales_data.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_sales_data.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_sales_data.turnover"
                                                       name="opened_data"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_sales_data.operating_expenses"
                                                       name="opened_data"><span>营业费用</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_sales_data.amount_repaid"
                                                       name="opened_data"><span>回款额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_sales_data.inventory"
                                                       name="opened_data"><span>库存量</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_sales_data.profit"
                                                       name="opened_data"><span>利润额</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile2_add">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="internal_control_indicators.order_date"
                                                       name="opened_data"><span>订单时间</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="internal_control_indicators.order_number"
                                                       name="opened_data"><span>订单号</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="internal_control_indicators.order_money"
                                                       name="opened_data"><span>订单额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.scheduled_delivery"
                                                       name="opened_data"><span>计划交期</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.target_well_done_rate"
                                                       name="opened_data"><span>目标成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.target_medical_expenses"
                                                       name="opened_data"><span>目标医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.target_comprehensive_cost"
                                                       name="opened_data"><span>目标综合成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.target_management_compliance"
                                                       name="opened_data"><span>目标管理符合数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.actual_delivery"
                                                       name="opened_data"><span>实际交期</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.finished_number"
                                                       name="opened_data"><span>完成数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.unfinished_number"
                                                       name="opened_data"><span>未完成数</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.actual_well_done_rate"
                                                       name="opened_data"><span>实际成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.actual_medical_expenses"
                                                       name="opened_data"><span>实际医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="internal_control_indicators.actual_cost"
                                                       name="opened_data"><span>实际成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="internal_control_indicators.actual_management_compliance"
                                                       name="opened_data"><span>实际管理符合数</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile3_add">
                                        <div class="example-box">
                                        <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="monthly_performance.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="monthly_performance.month"><span>月份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_performance.delivery_rate"
                                                       name="opened_data"><span>交付率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_performance.well_done_rate"
                                                       name="opened_data"><span>成品率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_performance.medical_expenses"
                                                       name="opened_data"><span>医药费</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="monthly_performance.month_dig_cost"
                                                       name="opened_data"><span>当月挖掘成本</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox"
                                                       value="monthly_performance.field_management_well_rate"
                                                       name="opened_data"><span>现场管理符合率</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="dropdown1_add">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_performance.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_performance.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_performance.turnover"
                                                       name="opened_data"><span>营业额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_performance.operating_rate"
                                                       name="opened_data"><span>营业费率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_performance.repaid_rate"
                                                       name="opened_data"><span>回款率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_performance.inventory_rate"
                                                       name="opened_data"><span>库存率</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_performance.profit_rate"
                                                       name="opened_data"><span>利润率</span>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="dropdown2_add">
                                        <div class="example-box">
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_award.year"><span>年份</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" name="opened_data"
                                                       value="quarterly_award.quarter"><span>季度</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.turnover_award"
                                                       name="opened_data"><span>营业额所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.operating_rate_award"
                                                       name="opened_data"><span>营业费率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.repaid_rate_award"
                                                       name="opened_data"><span>回款率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.inventory_rate_award"
                                                       name="opened_data"><span>库存率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.profit_rate_award"
                                                       name="opened_data"><span>利润率所得奖金额</span>
                                            </label>
                                            <label class="lyear-checkbox checkbox-inline checkbox-primary">
                                                <input type="checkbox" value="quarterly_award.total"
                                                       name="opened_data"><span>合计</span>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="id_request_method" class="control-label">请求方式：</label>
                            <select class="form-control" id="id_request_method" name="request_method" required>
                                <option value="GET">GET</option>
                                <option value="POST">POST</option>
                                <option value="POST+GET">POST+GET</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="api_brief" class="control-label">接口简介：</label>
                            <input type="text" class="form-control" id="api_brief" name="introduction" required>
                        </div>
                        <div class="form-group">
                            <label for="stock_n" class="control-label">是否启用：</label>
                            <label class="lyear-switch switch-primary">
                                <input type="checkbox" name="is_enabled" value="True" checked="">
                                <span></span>
                            </label>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                        <button type="submit" class="btn btn-primary">确定</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <!-- 删除接口模态框 -->
    <div class="modal fade" id="del" tabindex="-1" role="dialog" aria-labelledby="delsModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <form action="{% url 'delete_api' %}" method="post">
                    {% csrf_token %}
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="delsModalLabel">删除选中接口</h4>
                    </div>
                    <div class="modal-body">
                        确认删除该接口?
                    </div>
                    <div class="modal-footer">
                        <input hidden id="id_delete" name="delete_id">
                        <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                        <button type="submit" class="btn btn-danger">确定</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block main_content %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12">
                <div class="card">
                    <div class="card-header">
                        <h4><b>系统开放接口</b></h4>
                    </div>
                    <div class="card-toolbar clearfix">
                        <form class="pull-right search-bar" method="post"
                              action="#！" role="form">
                            {% csrf_token %}
                            <div class="input-group">
                                
                                <input hidden name="action" value="接口搜索">
                                <input type="text" class="form-control" name="api_search" aria-label="..."
                                       placeholder="名称/简介筛选..." value="{{ api_search }}">
                                <div class="input-group-btn">
                                    <button type="submit" class="btn btn-default">搜索</button>
                                </div>

                            </div>
                        </form>
                        <div class="toolbar-btn-action">
                            <button type="button" class="btn btn-dark m-r-5" data-toggle="modal"
                                    data-target="#add" data-whatever="@mdo"><i class="mdi mdi-plus"></i> 新增接口
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <!--手风琴效果-->
                        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                            <div class="panel">
                                <div class="panel-heading" role="tab" id="headingThree">
                                    <h4 class="panel-title">
                                        <a class="collapsed" role="button" data-toggle="collapse"
                                           data-parent="#accordion" href="#collapseThree" aria-expanded="false"
                                           aria-controls="collapseThree">
                                            接口修改时间筛选
                                        </a>
                                    </h4>
                                </div>

                                <div id="collapseThree" class="panel-collapse collapse" role="tabpanel"
                                     aria-labelledby="headingThree">
                                    <div class="panel-body">
                                        <form method="post" action="{% url 'show_open_api' %}" role="form">
                                            {% csrf_token %}
                                            <input hidden name="action" value="接口修改时间筛选">
                                            <div class="input-daterange input-group">
                                                <input class="form-control js-datetimepicker" type="text"
                                                       name="start_time"
                                                       placeholder="接口调整时间起点" data-side-by-side="true"
                                                       data-locale="zh-cn"
                                                       data-format="YYYY-MM-DD-HH-mm" required>
                                                <span class="input-group-addon"><i
                                                        class="mdi mdi-chevron-right"></i></span>
                                                <input class="form-control js-datetimepicker" type="text"
                                                       name="end_time"
                                                       placeholder="接口调整时间终点" data-side-by-side="true"
                                                       data-locale="zh-cn"
                                                       data-format="YYYY-MM-DD-HH-mm" required>
                                                <span class="input-group-btn" id="basic-addon3">
                                                <button class="btn btn-default" type="submit">筛选接口</button>
                                                </span>
                                            </div>
                                        </form>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <!--手风琴效果 End-->
                        <div id="table_display" class="table-responsive text-right">
                            <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th nowrap="nowrap" class="text-center">接口名称</th>
                                    <th nowrap="nowrap" class="text-center">映射链接</th>
                                    <th nowrap="nowrap" class="text-center">接口密码</th>
                                    <th nowrap="nowrap" class="text-center">请求方式</th>
                                    <th nowrap="nowrap" class="text-center">接口简介</th>
                                    <th nowrap="nowrap" class="text-center">创建时间</th>
                                    <th nowrap="nowrap" class="text-center">最近修改或调用时间</th>
                                    <th nowrap="nowrap" class="text-center">是否启用</th>
                                    <th nowrap="nowrap" class="text-center">调用次数</th>
                                    <th nowrap="nowrap" class="text-center">操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for data in datas %}
                                    <tr>
                                        <td nowrap="nowrap" class="text-center"><p>{{ data.name }}</p></td>
                                        <td nowrap="nowrap" class="text-center">
                                            <a><span
                                                    id="copyText_{{ forloop.counter }}">{{ site_url }}/get_api_data/{{ data.name }}</span></a>
                                            <span onclick="copy('copyText_{{ forloop.counter }}');" title="复制">
                                            <i class="mdi mdi-content-copy"></i></span></td>
                                        <td nowrap="nowrap" class="text-center">{{ data.password }}</td>
                                        <td nowrap="nowrap" class="text-center">{{ data.request_method }}</td>
                                        <td nowrap="nowrap" class="text-center">{{ data.introduction }}</td>
                                        <td nowrap="nowrap" class="text-center">{{ data.create_time }}</td>
                                        <td nowrap="nowrap" class="text-center">{{ data.change_time }}</td>
                                        {% if data.is_enabled %}
                                            <td nowrap="nowrap" class="text-center">
                                                <a class="btn btn-xs btn-default btn-primary" title="启用">
                                                    <i class="mdi mdi-check"></i></a></td>
                                        {% else %}
                                            <td nowrap="nowrap" class="text-center">
                                                <a class="btn btn-xs btn-default btn-danger" title="禁用">
                                                    <i class="mdi mdi-cancel"></i></a>
                                            </td>
                                        {% endif %}
                                        <td nowrap="nowrap" class="text-center">{{ data.called_times }}次</td>


                                        <td nowrap="nowrap" class="text-center">
                                            <div class="btn-group-justified">
                                                <a class="btn btn-xs btn-default" href="#!" title="修改接口"
                                                   data-toggle="modal"
                                                   data-target="#modify" onclick="give_change_modal('{{ data.id }}',
                                                        '{{ data.name }}', '{{ data.password }}', '{{ data.request_method }}', 
                                                        '{{ data.introduction }}', '{{ data.is_enabled }}', {{ data.opened_data|to_list }})">
                                                        <i class="mdi mdi-pencil"></i></a>
                                                <a class="btn btn-xs btn-default" href="#!" title="删除"
                                                   data-toggle="modal"
                                                   data-target="#del" onclick="give_delete_modal('{{ data.id }}')"><i
                                                        class="mdi mdi-window-close"></i></a>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block js_content %}
    <!--点击映射复制映射链接-->
    <script type="text/javascript">

        function copy(get_id) {
            var text = document.getElementById(get_id).innerText;
            var input = document.createElement('input');
            input.setAttribute('id', 'copyInput');
            input.setAttribute('value', text);
            document.getElementsByTagName('body')[0].appendChild(input);
            document.getElementById('copyInput').select();
            if (document.execCommand('copy')) {
                lightyear.notify('复制成功', 'success', 3000);
            }
            document.getElementById('copyInput').remove();
        }

    </script>
    <!--时间选择插件-->
    <script src="{% static 'js/bootstrap-datetimepicker/moment.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-datetimepicker/locale/zh-cn.js' %}"></script>
    <link rel="stylesheet" href="{% static 'js/bootstrap-datetimepicker/bootstrap-datetimepicker.min.css' %}">
    <!--日期选择插件-->
    <script type="text/javascript" src="{% static 'js/bootstrap-datepicker/bootstrap-datepicker.min.js' %}"></script>
    <script type="text/javascript"
            src="{% static 'js/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'js/bootstrap-datepicker/bootstrap-datepicker3.min.css' %}" type="text/css">
    <link href="{% static 'css/style.min.css' %}" rel="stylesheet" type="text/css">
    <!-- 消息提示框 -->
    {% if messages %}
        {% for message in messages %}
            {% if message.tags == 'success' %}
                <script type="text/javascript">
                    lightyear.notify('{{ message }}', 'success', 3000);
                </script>
            {% elif message.tags == 'error' %}
                <script type="text/javascript">
                    lightyear.notify('{{ message }}', 'danger', 3000);
                </script>
            {% endif %}
        {% endfor %}
    {% endif %}
    <!-- 给修改模态框传值 -->
    <script type="text/javascript">
        function give_change_modal(change_id,
                                   change_name,
                                   change_password,
                                   change_request_method,
                                   change_introduction,
                                   change_is_enabled,
                                   opened_data) {
            $('#id_change_id').val(change_id);
            $('#id_change_name').val(change_name);
            $('#id_change_password').val(change_password);
            $('#id_change_request_method').val(change_request_method);
            $('#id_change_introduction').val(change_introduction);
            $('#id_change_is_enabled').val(change_is_enabled);
            if (change_is_enabled == 'False') {
                $('#id_change_is_enabled').prop("checked", false);
            }
            else {
                $('#id_change_is_enabled').prop("checked", true);
            }
            // 将现有的开关处于关闭状态
            var checkbox = document.getElementsByName('opened_data');
            for (var i = 0; i < checkbox.length; i++) {
                checkbox[i].checked = false;
            }
            // 遍历取到的数据列表
            // 通过id来选取相应的开关组件，并将它们设置为打开状态
            for (var i = 0; i < opened_data.length; i++) {
                var checkbox = document.getElementById(opened_data[i]);
                checkbox.checked = true;
            }
        }
    </script>
    <!-- 给确认删除模态框传值 -->
    <script type="text/javascript">
        function give_delete_modal(delete_id) {
            $('#id_delete').val(delete_id);
        }
    </script>
    <!-- 给下载备份文件模态框传值 -->
    <script type="text/javascript">
        function give_download_modal(file_name) {
            $('#id_download_file').val(file_name);
        }
    </script>

{% endblock %}